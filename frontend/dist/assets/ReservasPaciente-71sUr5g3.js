import{f as y,a as R,r,U as C,T as b,$ as f,k as v,n as h,i as m,j as n,B as x,a2 as j,N as S,O as T,l as w,_ as E}from"./index-eEc2nAUg.js";import{C as A}from"./ContenedorReservas-phHVPwJb.js";import{P as N}from"./Pagination-Ze_o0khu.js";import"./LoaderChico-upnhU-Wf.js";import"./formatHoraUser-TJ92Iw1g.js";const _=async(e,t,s)=>{const o={headers:{"Content-Type":"application/json",Authorization:`Bearer ${e||""}`}},a=`${R.reservas.deUnPacientes}${t}/${s}`;return await y(a,o)},O=e=>{const{accessToken:t}=r.useContext(C),{setMensaje:s}=r.useContext(b),{dispatch:o}=f(),{setLoading:a}=r.useContext(v),[i,c]=r.useState(1),[l,u]=r.useState(!1);return r.useEffect(()=>{(async()=>{try{a(!0);const g=await _(t,i,e),{status:P,error:d,datos:p}=g;P===200?(o({type:h.SET_RESERVAS,payload:p.reservas}),c(p.page),u(p.totalPages)):s(d||"Ocurrió un error al obtener las reservas del paciente")}catch{s("Ocurrió un error al obtener las reservas del paciente")}finally{a(!1)}})()},[t,i,o,s,e,a]),{pagina:i,totalPaginas:l,setPagina:c}},U=({handleAgregarReserva:e})=>{const t=m();return n.jsxs("header",{className:"border-b border-slate-500 p-4 grid grid-flow-col",children:[n.jsx(x,{className:"border border-color-violeta bg-transparent  flex items-center justify-center max-w-fit justify-self-center rounded-lg px-4 py-2  hover:opacity-70 transition-opacity ",tipo:"button",onClickFunction:()=>t(-1),texto:"Volver"}),n.jsx(x,{className:"border border-color-violeta bg-transparent  flex items-center justify-center max-w-fit justify-self-center rounded-lg px-4 py-2  hover:opacity-70 transition-opacity ",tipo:"button",onClickFunction:e,texto:"Agregar Reserva"})]})},V=()=>{const{id:e}=j(),t=m(),{paciente:s}=S(),{loading:o}=r.useContext(v),{reservas:a}=f(),{totalPaginas:i,setPagina:c}=O(e),{obtenerPacientePorId:l}=T(),u=async()=>{await l(e),t(w.admin.agregarReserva,{state:{reserva:{paciente:{nombre:s.nombre},horario:{horaInicio:E.split("T")[0]}}}})};return n.jsxs("section",{className:"grid grid-rows-[70px_auto_1fr] gap-4 mx-auto max-w-5xl w-full p-4",children:[n.jsx(U,{handleAgregarReserva:u}),a.length>0&&n.jsx(N,{loading:o,totalPages:i,onPageChange:c}),n.jsx(A,{reservas:a})]})};export{V as default};
