import{j as e,E as w,u as S,r as i,H as D,A as y}from"./index-bGblmpTd.js";import{O as H,C as L}from"./OpenInfo-3xvWKTMF.js";import{u as R,a as I,f as T,b as E}from"./useUserContext-ZLo1aMkK.js";import{f as $}from"./useReservasContext-bDli98VY.js";import{L as C}from"./LabelInput-vZH92CXT.js";import{u as M}from"./useForm-dmK4_1hC.js";import{T as q}from"./TextAreaLabel-3Zz3tFXL.js";import{u as X}from"./useFormReserva-OxhSwNAK.js";import{B as F}from"./Button-9xCFGcvS.js";import"./useObserver-oB8vhmWg.js";import"./compararFechas-h4mI52ve.js";function j(t){return t.split(" ").map(s=>s[0].toUpperCase()+s.substring(1)).join(" ")}const V=t=>{const s="59894539587",a=`Me interesa hacer la siguiente reserva. 
  Nombre: ${j(t.nombre)}.
  Fecha: ${j($(`${t.fecha} ${t.hora}`))}.
  Hora: ${t.hora}. 
  Observaciones: ${j(t.observaciones)}.`;window.open(`https://wa.me/${s}?text=${encodeURIComponent(a)}`,"_blank")},B=({values:t,handleSetHora:s,horasDisponibles:a})=>e.jsxs("ul",{className:"grid gap-4 grid-cols-5",children:[e.jsx("li",{className:"col-span-full",children:"Horas disponibles"}),a.map((o,n)=>n!==0&&n!==1&&o.estado!==w.pendiente&&o.estado!==w.pago&&!o.proximaHoraNoDisponible&&e.jsx("li",{className:`p-2 rounded-xl w-full grid place-content-center shadow-md ${o.id.split("T")[1]===t.hora?"col-span-full row-start-2 bg-color-violeta text-slate-50 max-w-md transition-[max-width]":"bg-slate-50 max-w-20 hover:opacity-50 cursor-pointer transition-opacity"}`,onClick:()=>s(o.id.split("T")[1]),children:o.id.split("T")[1]},o.id))]}),U=({values:t,horasDisponibles:s})=>e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"font-betonga text-color-violeta font-bold capitalize text-center underline underline-offset-4 text-2xl px-4",children:"Resumen"}),t.nombre&&e.jsxs("span",{className:"bg-color-verde-blanco text-color-violeta py-2 px-4 grid grid-cols-[1fr,2fr] rounded capitalize",children:["Nombre ",e.jsx("strong",{className:"text-end text-balance",children:t.nombre})]}),t.fecha&&e.jsxs("span",{className:"bg-color-verde-blanco text-color-violeta py-2 px-4 grid grid-cols-[1fr,2fr] rounded capitalize",children:["Dia"," ",e.jsx("strong",{className:"text-end text-balance",children:$(`${t.fecha} ${t.hora}`)})]}),t.hora&&s.length>0&&e.jsxs("span",{className:"bg-color-verde-blanco text-color-violeta py-2 px-4 grid grid-cols-[1fr,2fr] rounded capitalize",children:["Hora ",e.jsx("strong",{className:"text-end text-balance",children:t.hora})]}),t.observaciones&&e.jsxs("span",{className:"bg-color-verde-blanco text-color-violeta py-2 px-4 grid gap-4 rounded capitalize",children:["Observación ",e.jsx("strong",{className:"text-pretty",children:t.observaciones})]})]}),P={nombre:{required:!0},fecha:{required:!0},hora:{required:!0}},O=({observaciones:t,cerrarFormulario:s})=>{const{loading:a}=R(),{setMensaje:o}=S(),n=i.useRef(),u={nombre:"",fecha:"",hora:"",observaciones:t||""},{errors:l,handleChange:f,values:r,validateForm:p}=M(u,P),{horasDisponibles:x}=X(r.fecha),b=new Date(r.fecha).getDay()===6,g=m=>{m.preventDefault(),p()&&!b&&r.nombre?(V(r),c()):o("Faltan campos requeridos.")},c=()=>{n.current.classList.add("animate-fadeOut")},d=m=>{f({target:{name:"hora",value:m}})};return e.jsxs("section",{id:"sectionForm",ref:n,className:"grid grid-rows-[50px_1fr] p-4 py-8",onAnimationEnd:m=>{m.target.id==="sectionForm"&&m.animationName!=="fadeIn"&&s()},children:[e.jsx("h1",{className:"font-betonga text-color-violeta font-bold capitalize text-center underline underline-offset-4 text-2xl px-4",children:"Reserva"}),e.jsxs("form",{onSubmit:g,className:"animate-fadeIn grid w-full max-w-md py-8 px-4 rounded-lg bg-color-logo gap-4 m-auto border border-black",children:[e.jsx(C,{errors:l,labelText:"Nombre",name:"nombre",onChange:f,placeholder:"Nombre",type:"text",value:r.nombre}),e.jsx(C,{className:"w-full",errors:l,labelText:"Fecha",name:"fecha",onChange:m=>{f(m),d("")},type:"date",value:r.fecha,min:D.split("T")[0]}),b?e.jsx("span",{className:"p-2 rounded-xl w-full text-center shadow-md bg-color-violeta text-slate-50",children:"* Los días domingos no se realizan reservas"}):null,x.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(B,{horasDisponibles:x,handleSetHora:d,values:r}),l.hora&&e.jsx("small",{className:"text-red-600",children:"* Este campo es requerido"})]}),e.jsx(q,{disabled:!0,value:r.observaciones,placeholder:"Observación",onChange:f,name:"observaciones",labelText:"Observación",error:l.observaciones}),e.jsx(U,{horasDisponibles:x,values:r}),e.jsxs("footer",{className:"grid grid-flow-col pt-8 px-4 gap-4",children:[e.jsx(F,{className:"w-full",tipo:"button",onClickFunction:c,texto:"Volver"}),e.jsx(F,{className:"w-full",bgColor:!0,tipo:"submit",texto:"Enviar",disabled:a})]})]})]})},G=()=>{const[t,s]=i.useState(0),[a,o]=i.useState([]),{setMensaje:n}=S(),{accessToken:u}=I();return i.useEffect(()=>{(async()=>{const p=E.publicas.getPromociones,x={headers:{authorization:`Bearer ${u}`}},b=await T(p,x),{error:g,datos:c,status:d}=b;d===200?o(c):n(g||"Error al obtener los datos")})()},[n,u]),i.useEffect(()=>{const p=setInterval(()=>{const x=(t+1)%a.length;s(x)},5e3);return()=>{clearInterval(p)}},[t,a.length]),{promos:a,nextSlide:()=>{const r=(t+1)%a.length;s(r)},prevSlide:()=>{const r=(t-1+a.length)%a.length;s(r)},currentIndex:t}},Y=({promos:t,handleReservar:s,currentIndex:a})=>e.jsx("div",{className:"overflow-hidden flex rounded-lg border border-slate-500",children:t.map(o=>{var n,u;return e.jsxs("figure",{className:"transition-transform duration-500 relative flex-[0_0_100%]",style:{transform:`translateX(-${a*100}%)`},children:[e.jsx("img",{className:"object-cover w-full h-full bg-slate-50 aspect-square max-h-[500px]",src:((n=o.imagen)==null?void 0:n.secure_url)||((u=o.servicio.imagen)==null?void 0:u.secure_url),alt:o.nombre}),e.jsx("button",{className:"absolute w-full max-w-64 bottom-4 left-1/2 -translate-x-1/2 font-bold text-slate-50 border-color-violeta bg-color-violeta border-[1px] rounded-md py-2 px-4 transition-colors hover:text-color-violeta hover:bg-transparent",onClick:()=>s(o),children:"Reservar"})]},o._id)})}),J=()=>{const[t,s]=i.useState(!1),[a,o]=i.useState(""),{nextSlide:n,prevSlide:u,promos:l,currentIndex:f}=G(),r=i.useRef(null),p=c=>{r.current=c.touches[0].clientX},x=()=>{r.current},b=c=>{if(r.current===null)return;const d=c.touches[0].clientX,m=r.current-d;m>50?n():m<-50&&u()},g=c=>{const d=`${c.servicio.nombre} - ${c.descripcion}`;o(d),s(!0)};return l instanceof Array?l.length>0&&e.jsxs(e.Fragment,{children:[t&&e.jsx(O,{observaciones:a,cerrarFormulario:()=>s(!1)}),e.jsxs("section",{className:"relative flex justify-center max-w-4xl m-auto mb-8",onTouchStart:p,onTouchMove:b,onTouchEnd:x,children:[l.length>1&&e.jsx("span",{className:"rounded-md cursor-pointer text-4xl absolute z-10 left-0 top-1/2 flex justify-center items-center rotate-90 transition-transform px-4 bg-[#00000025] hover:bg-[#0000003f] hover:scale-95",onClick:u,children:e.jsx(y,{})}),e.jsx(Y,{currentIndex:f,handleReservar:g,promos:l}),l.length>1&&e.jsx("span",{className:"rounded-md cursor-pointer text-4xl absolute z-10 right-0 top-1/2 flex justify-center items-center -rotate-90 transition-transform px-4 bg-[#00000025] hover:bg-[#0000003f] hover:scale-95",onClick:n,children:e.jsx(y,{})}),e.jsx("div",{className:" overflow-hidden absolute rounded-xl px-4 py-2 bg-[#00000025] -bottom-10 flex justify-center gap-x-4 m-auto",children:Array.from(l).map((c,d)=>e.jsx("span",{className:`${d===f?"bg-color-violeta translate-y-0":"translate-y-8"} rounded-full w-4 h-4 transition duration-500`},d))})]})]}):null},K=J;function ce(){const{setMensaje:t}=S(),{setLoading:s}=R(),{accessToken:a}=I(),[o,n]=i.useState([]),[u,l]=i.useState(null),[f,r]=i.useState(!1),[p,x]=i.useState(!1),[b,g]=i.useState(""),c=i.useRef();i.useEffect(()=>{try{s(!0),(async()=>{const v=E.publicas.getServicios,z={headers:{authorization:`Bearer ${a}`}},A=await T(v,z),{error:N,datos:_,status:k}=A;k===200?(n(_),s(!1)):(s(!1),t(N||"Error al obtener los servicios"))})()}catch{s(!1),t("Error al obtener los servicios")}},[t,a,s]);const d=h=>{l(h),x(!0)},m=(h,v)=>{c.current.scrollIntoView(),g(v),l(h),r(!0)};return e.jsxs("main",{className:"animate-fadeIn grid py-8 px-4 gap-8 ",ref:c,children:[e.jsx("h1",{className:"font-betonga text-color-violeta font-bold text-3xl text-center",children:"Servicios"}),e.jsx(K,{}),p&&e.jsx(O,{observaciones:u.nombre,cerrarFormulario:()=>x(!1)}),f&&!p&&e.jsx(H,{setOpenInfo:r,imgSrc:b,servicio:u,reservar:d}),e.jsx("section",{className:"grid gap-8 grid-cols-1 md:grid-cols-2 lg:grid-cols-3 max-w-5xl mx-auto",children:o instanceof Array&&!p&&!f&&o.map(h=>h.nombre!=="admin"&&e.jsx(L,{servicio:h,abrirMasInfo:m,reservar:d,setServicio:l},h._id))})]})}export{ce as default};
